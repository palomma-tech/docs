openapi: 3.0.1
info:
  title: Palomma API
  version: ''
paths:
  /payment-requests:
    post:
      operationId: paymentRequest_post
      tags:
        - PaymentRequest
      parameters: []
      responses:
        '200':
          description: ''
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CreatePaymentRequestResponse'
              examples:
                Example1:
                  value:
                    id: 8f59ec29-3e8a-4cbd-b4c0-4f480b1fac15
                    payment_url: >-
                      https://www.sandbox-pay.palomma.com/?transaccion=8f59ec29-3e8a-4cbd-b4c0-4f480b1fac15
        '400':
          description: ''
          content:
            application/json:
              schema:
                oneOf:
                  - type: object
                    properties:
                      errorName:
                        type: string
                        enum:
                          - BadRequestError
                      content:
                        $ref: '#/components/schemas/ErrorBody'
        '401':
          description: ''
          content:
            application/json:
              schema:
                oneOf:
                  - type: object
                    properties:
                      errorName:
                        type: string
                        enum:
                          - UnauthorizedError
                      content:
                        $ref: '#/components/schemas/ErrorBody'
      summary: Crear solicitud de pago
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                amount_cents:
                  type: integer
                  description: >-
                    El monto de la transacción en centavos. Debe ser mayor a
                    300.000, y menor a 80.000.000.
                  example: 300000
                description:
                  type: string
                  description: >-
                    Descripción opcional para la solicitud de pago. Puede ser
                    una referencia de pago o algún texto breve que describa la
                    transacción. El usuario verá esta descripción.
                redirect_url:
                  type: string
                  description: >-
                    La URL a la que se redirecciona al usuario cuando haya
                    terminado el pago a través de Palomma. Sobreescribe la URL
                    de redirección configurado en el
                    [Onboarding](/general/onboarding).
                ttl:
                  type: integer
                  description: >-
                    El tiempo en segundos que puede quedar la transacción en
                    estado pendiente antes de ser cancelada. Si no se especifica
                    y no está especificado para tu comercio en el
                    [Onboarding](/general/onboarding), la solicitud de pago no
                    expira.
                enforced_document_number:
                  type: string
                  description: >-
                    Impone que la cuenta de banco vinculada a Palomma para
                    realizar el pago esté asociada con la cédula especificada.
                    Principalmente util por temas de cumplimento de normativas.
                    Utilice este campo si necesita verificar que la cuenta de
                    banco que se vincula a Palomma para realizar el pago la
                    pertenece al usuario que está registrado en su servicio. Si
                    la cuenta de banco no está asociada con la cédula
                    especificada, el usuario no podrá completar su pago. Si no
                    se especifica, no se verifica la cédula. Esta verificación
                    aún no está activa con todos los bancos disponibles.
                merchant_display_name:
                  type: string
                  description: >-
                    Especifica un nombre alternativo para el comercio que se le
                    muestra al usuario.
                merchant_support_info:
                  type: string
                  description: >-
                    Información de contacto alternativa que se le muestra al
                    usuario en la confirmación de pago.
              required:
                - amount_cents
            examples:
              Example1:
                value:
                  amount_cents: 300000
                  description: Pay subscription
                  redirect_url: https://palomma.com
  /payment-requests/{transactionId}:
    get:
      operationId: paymentRequest_get
      tags:
        - PaymentRequest
      parameters:
        - name: transactionId
          in: path
          description: Un identificador único para la solicitud de pago.
          required: true
          schema:
            $ref: '#/components/schemas/TransactionId'
          examples:
            Example1:
              value: 8f59ec29-3e8a-4cbd-b4c0-4f480b1fac15
      responses:
        '200':
          description: ''
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaymentRequest'
              examples:
                Example1:
                  value:
                    id: 8f59ec29-3e8a-4cbd-b4c0-4f480b1fac15
                    status: PENDING
                    amount_cents: 300000
                    description: Pay subscription
        '400':
          description: ''
          content:
            application/json:
              schema:
                oneOf:
                  - type: object
                    properties:
                      errorName:
                        type: string
                        enum:
                          - BadRequestError
                      content:
                        $ref: '#/components/schemas/ErrorBody'
        '401':
          description: ''
          content:
            application/json:
              schema:
                oneOf:
                  - type: object
                    properties:
                      errorName:
                        type: string
                        enum:
                          - UnauthorizedError
                      content:
                        $ref: '#/components/schemas/ErrorBody'
        '403':
          description: ''
          content:
            application/json:
              schema:
                oneOf:
                  - type: object
                    properties:
                      errorName:
                        type: string
                        enum:
                          - ForbiddenError
                      content:
                        $ref: '#/components/schemas/ErrorBody'
        '404':
          description: ''
          content:
            application/json:
              schema:
                oneOf:
                  - type: object
                    properties:
                      errorName:
                        type: string
                        enum:
                          - PaymentRequestNotFoundError
      summary: Revisar estado del pago
  /subscription-requests:
    post:
      operationId: subscriptionRequest_post
      tags:
        - SubscriptionRequest
      parameters: []
      responses:
        '200':
          description: ''
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CreateSubscriptionRequestResponse'
              examples:
                Example1:
                  value:
                    id: 8f59ec29-3e8a-4cbd-b4c0-4f480b1fac15
                    subscription_url: >-
                      https://www.sandbox-pay.palomma.com/?suscripcion=8f59ec29-3e8a-4cbd-b4c0-4f480b1fac15
        '400':
          description: ''
          content:
            application/json:
              schema:
                oneOf:
                  - type: object
                    properties:
                      errorName:
                        type: string
                        enum:
                          - BadRequestError
                      content:
                        $ref: '#/components/schemas/ErrorBody'
        '401':
          description: ''
          content:
            application/json:
              schema:
                oneOf:
                  - type: object
                    properties:
                      errorName:
                        type: string
                        enum:
                          - UnauthorizedError
                      content:
                        $ref: '#/components/schemas/ErrorBody'
      summary: Crear solicitud de suscripción
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                amount_cents:
                  type: integer
                  description: >-
                    El monto en centavos que se debe cobrar en cada fecha de
                    cobro. Debe ser mayor a 300000.
                  example: 300000
                redirect_url:
                  type: string
                  description: >-
                    La URL a la que se redirecciona al usuario cuando haya
                    terminado el flujo de suscripción a través de Palomma.
                  example: https://palomma.com
                description:
                  type: string
                  description: >-
                    Descripción opcional para la suscripción. Puede ser una
                    referencia o algún texto breve que describa la suscripción.
                interval:
                  type: integer
                  description: >-
                    Número de interal_units entre fechas de cobro. Debe ser
                    mayor o igual a 1. Por defecto es 1.
                interval_unit:
                  $ref: '#/components/schemas/IntervalUnit'
                  description: Unidad para especificar tiempo entre fechas de cobro.
                count:
                  type: integer
                  description: Número de pagos que se deben hacer por esta suscripción
                start_date:
                  type: string
                  description: >-
                    La fecha (YYYY-MM-DD) en la que se debe realizar el primer
                    pago.
                enforced_document_number:
                  type: string
                  description: >-
                    Impone que la cuenta de banco vinculada a Palomma para
                    realizar el pago esté asociada con la cédula especificada.
                    Principalmente util por temas de cumplimento de normativas.
                    Utilice este campo si necesita verificar que la cuenta de
                    banco que se vincula a Palomma para realizar el pago la
                    pertenece al usuario que está registrado en su servicio. Si
                    la cuenta de banco no está asociada con la cédula
                    especificada, el usuario no podrá completar su pago. Si no
                    se especifica, no se verifica la cédula. Esta verificación
                    aún no está activa con todos los bancos disponibles.
              required:
                - amount_cents
                - redirect_url
                - interval_unit
            examples:
              Example1:
                value:
                  amount_cents: 300000
                  description: Pay subscription
                  redirect_url: https://palomma.com
                  interval_unit: month
  /subscription-requests/{subscriptionId}:
    get:
      operationId: subscriptionRequest_get
      tags:
        - SubscriptionRequest
      parameters:
        - name: subscriptionId
          in: path
          description: Un identificador único para la solicitud de suscripción.
          required: true
          schema:
            $ref: '#/components/schemas/SubscriptionId'
          examples:
            Example1:
              value: 8f59ec29-3e8a-4cbd-b4c0-4f480b1fac15
      responses:
        '200':
          description: ''
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SubscriptionRequest'
              examples:
                Example1:
                  value:
                    id: 8f59ec29-3e8a-4cbd-b4c0-4f480b1fac15
                    status: ACTIVE
                    amount_cents: 300000
                    description: Pay subscription
                    interval: 1
                    interval_unit: month
                    past_payments: []
        '400':
          description: ''
          content:
            application/json:
              schema:
                oneOf:
                  - type: object
                    properties:
                      errorName:
                        type: string
                        enum:
                          - BadRequestError
                      content:
                        $ref: '#/components/schemas/ErrorBody'
        '401':
          description: ''
          content:
            application/json:
              schema:
                oneOf:
                  - type: object
                    properties:
                      errorName:
                        type: string
                        enum:
                          - UnauthorizedError
                      content:
                        $ref: '#/components/schemas/ErrorBody'
        '403':
          description: ''
          content:
            application/json:
              schema:
                oneOf:
                  - type: object
                    properties:
                      errorName:
                        type: string
                        enum:
                          - ForbiddenError
                      content:
                        $ref: '#/components/schemas/ErrorBody'
        '404':
          description: ''
          content:
            application/json:
              schema:
                oneOf:
                  - type: object
                    properties:
                      errorName:
                        type: string
                        enum:
                          - NotFoundError
                      content:
                        $ref: '#/components/schemas/ErrorBody'
      summary: Revisar estado de la suscripción
    delete:
      operationId: subscriptionRequest_delete
      tags:
        - SubscriptionRequest
      parameters:
        - name: subscriptionId
          in: path
          description: Un identificador único para la solicitud de suscripción.
          required: true
          schema:
            $ref: '#/components/schemas/SubscriptionId'
          examples:
            Example1:
              value: 8f59ec29-3e8a-4cbd-b4c0-4f480b1fac15
      responses:
        '200':
          description: ''
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SubscriptionRequest'
              examples:
                Example1:
                  value:
                    id: 8f59ec29-3e8a-4cbd-b4c0-4f480b1fac15
                    status: CANCELLED
                    amount_cents: 300000
                    description: Pay subscription
                    interval: 1
                    interval_unit: month
                    past_payments: []
        '401':
          description: ''
          content:
            application/json:
              schema:
                oneOf:
                  - type: object
                    properties:
                      errorName:
                        type: string
                        enum:
                          - UnauthorizedError
                      content:
                        $ref: '#/components/schemas/ErrorBody'
        '403':
          description: ''
          content:
            application/json:
              schema:
                oneOf:
                  - type: object
                    properties:
                      errorName:
                        type: string
                        enum:
                          - ForbiddenError
                      content:
                        $ref: '#/components/schemas/ErrorBody'
        '404':
          description: ''
          content:
            application/json:
              schema:
                oneOf:
                  - type: object
                    properties:
                      errorName:
                        type: string
                        enum:
                          - NotFoundError
                      content:
                        $ref: '#/components/schemas/ErrorBody'
      summary: Cancelar suscripción
components:
  schemas:
    MerchantId:
      type: string
    TransactionId:
      type: string
    SubscriptionId:
      type: string
    PaymentRail:
      type: string
      enum:
        - bancolombia_token
        - nequi_token
        - daviplata_api
        - pse
    ErrorBody:
      type: object
      properties:
        message:
          type: string
    CreatePaymentRequestResponse:
      type: object
      properties:
        id:
          $ref: '#/components/schemas/TransactionId'
          description: Un identificador único para la solicitud de pago.
        payment_url:
          type: string
          description: >-
            El enlace de pago al que se debe redirigir al usuario para realizar
            el pago.
          example: >-
            https://www.sandbox-pay.palomma.com/?transaccion=8f59ec29-3e8a-4cbd-b4c0-4f480b1fac15
      required:
        - id
        - payment_url
    PaymentRequest:
      type: object
      properties:
        id:
          $ref: '#/components/schemas/TransactionId'
          description: Un identificador único para la solicitud de pago.
        status:
          type: string
          description: >-
            El estado actual de la solicitud de pago. [Posibles
            estados.](/general/estados)
          example: PENDING
        amount_cents:
          type: integer
          description: El monto de la transacción en centavos.
          example: 300000
        description:
          type: string
          description: >-
            Descripción opcional para la solicitud de pago. Puede ser una
            referencia de pago o algún texto breve que describa la transacción.
        enforced_document_number:
          type: string
          description: >-
            La cédula que debe corresponder a la asociada con la cuenta de banco
            de la cual se hace el pago. Si no se especificó, no se verifica la
            cédula.
      required:
        - id
        - status
        - amount_cents
    CreateSubscriptionRequestResponse:
      type: object
      properties:
        id:
          $ref: '#/components/schemas/SubscriptionId'
          description: Un identificador único para la solicitud de suscripción.
        subscription_url:
          type: string
          description: >-
            El enlace de suscripción al que se debe redirigir al usuario para
            completar la suscripción.
          example: >-
            https://www.sandbox-pay.palomma.com/?suscripcion=8f59ec29-3e8a-4cbd-b4c0-4f480b1fac15
      required:
        - id
        - subscription_url
    SubscriptionRequest:
      type: object
      properties:
        id:
          $ref: '#/components/schemas/SubscriptionId'
          description: Un identificador único para la solicitud de suscripción.
        status:
          type: string
          description: El estado actual de la solicitud de suscripción.
          example: ACTIVE
        amount_cents:
          type: integer
          description: El monto en centavos que se debe cobrar en cada fecha de cobro.
          example: 300000
        description:
          type: string
          description: >-
            Descripción opcional para la solicitud de suscripción. Puede ser una
            referencia o algún texto breve que describa la suscripción.
        interval:
          type: integer
          description: >-
            Número de interal_units entre fechas de cobro. Debe ser mayor o
            igual a 1. Por defecto es 1.
        interval_unit:
          $ref: '#/components/schemas/IntervalUnit'
          description: Unidad para especificar tiempo entre fechas de cobro.
        past_payments:
          type: array
          items:
            $ref: '#/components/schemas/Transaction'
      required:
        - id
        - status
        - amount_cents
        - interval_unit
        - past_payments
    IntervalUnit:
      type: string
      enum:
        - day
        - week
        - month
        - year
    Transaction:
      type: object
      properties:
        id:
          $ref: '#/components/schemas/TransactionId'
        amount_cents:
          type: integer
        merchant:
          $ref: '#/components/schemas/MerchantId'
        status:
          $ref: '#/components/schemas/TransactionStatus'
        payment_rail:
          $ref: '#/components/schemas/PaymentRail'
        redirect_url:
          type: string
        credits:
          type: integer
        enforced_document_number:
          type: string
        merchant_display_name:
          type: string
        payment_url:
          type: string
        created_at:
          type: integer
        processed_at:
          type: integer
      required:
        - id
        - amount_cents
        - merchant
        - status
        - created_at
    TransactionStatus:
      type: string
      enum:
        - PENDING
        - PROCESSING
        - ERROR
        - DECLINED
        - APPROVED
        - CANCELLED
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
servers:
  - url: https://api.pay.palomma.com/
    description: Production
  - url: https://api.sandbox-pay.palomma.com/
    description: Sandbox
